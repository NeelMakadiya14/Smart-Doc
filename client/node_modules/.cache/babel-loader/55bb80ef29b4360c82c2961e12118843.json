{"ast":null,"code":"import _toConsumableArray from\"/media/neel/DATA/WebD/Smart Doc/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/media/neel/DATA/WebD/Smart Doc/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useRef}from'react';import'./Chat.css';import{Avatar,IconButton}from\"@material-ui/core\";import EmojiEmotionsOutlinedIcon from'@material-ui/icons/EmojiEmotionsOutlined';import AddIcCallOutlinedIcon from'@material-ui/icons/AddIcCallOutlined';import{CookiesProvider,Cookies,useCookies}from'react-cookie';import io from\"socket.io-client\";import axios from\"axios\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Chat(props){var cookies=new Cookies();var userCookie=cookies.get('userCookie');var userName=userCookie.name;var socketRef=useRef();var _useState=useState(''),_useState2=_slicedToArray(_useState,2),input=_useState2[0],setInput=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),messages=_useState4[0],setMessages=_useState4[1];console.log(\"Test\");var url=process.env.NODE_ENV===\"production\"?\"https://thawing-dawn-49846.herokuapp.com/\":\"http://localhost:5000/\";console.log(process.env.NODE_ENV,url);var userDetail={room:props.roomID,name:userCookie.name,GID:userCookie.GID,imgURI:\"123\"};window.onbeforeunload=function(){if(socketRef.current){socketRef.current.close();}};useEffect(function(){axios.get(\"\".concat(url,\"chat?room=\").concat(props.roomID)).then(function(res){console.log(res.data);setMessages(res.data);});socketRef.current=io.connect(url);socketRef.current.emit(\"join chat room\",userDetail);console.log(\"Inside UseEffect : \",messages);socketRef.current.on('recevied msg',function(data){console.log(\"yes received..\");setMessages(function(msgs){return[].concat(_toConsumableArray(msgs),[data]);});console.log(messages);});},[]);var sendMessage=function sendMessage(e){e.preventDefault();var obj={userName:userName,photoUri:\"123\",msg:input,time:new Date(),room:props.roomID};socketRef.current.emit('send msg',obj);//     axios.post(`${url}chat`,obj,{headers: {\n//     'Content-Type': 'application/json'\n//   }}).then((res)=>{\n//         console.log(res);\n//     })\nsetInput('');};return/*#__PURE__*/_jsxs(\"div\",{className:\"chat\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"chat__header\",children:[/*#__PURE__*/_jsx(Avatar,{src:\"\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Room Name\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"chat__body\",children:messages.map(function(message,i){return/*#__PURE__*/_jsxs(\"p\",{className:\"chat__message \".concat(userCookie.name===message.userName&&'chat__receiver'),children:[/*#__PURE__*/_jsx(\"span\",{className:\"chat__name\",children:message.userName}),message.msg,/*#__PURE__*/_jsx(\"span\",{className:\"chat__timestamp\",children:message.time})]},i);})}),/*#__PURE__*/_jsxs(\"div\",{className:\"chat__footer\",children:[/*#__PURE__*/_jsx(IconButton,{children:/*#__PURE__*/_jsx(EmojiEmotionsOutlinedIcon,{})}),/*#__PURE__*/_jsxs(\"form\",{children:[/*#__PURE__*/_jsx(\"input\",{value:input,onChange:function onChange(e){return setInput(e.target.value);},placeholder:\"Type a message\",type:\"text\"}),/*#__PURE__*/_jsx(\"button\",{onClick:sendMessage,type:\"submit\",children:\"Send message\"})]}),/*#__PURE__*/_jsx(IconButton,{children:/*#__PURE__*/_jsx(AddIcCallOutlinedIcon,{})})]})]});}export default Chat;","map":{"version":3,"sources":["/media/neel/DATA/WebD/Smart Doc/client/src/routes/Chat.js"],"names":["React","useState","useEffect","useRef","Avatar","IconButton","EmojiEmotionsOutlinedIcon","AddIcCallOutlinedIcon","CookiesProvider","Cookies","useCookies","io","axios","Chat","props","cookies","userCookie","get","userName","name","socketRef","input","setInput","messages","setMessages","console","log","url","process","env","NODE_ENV","userDetail","room","roomID","GID","imgURI","window","onbeforeunload","current","close","then","res","data","connect","emit","on","msgs","sendMessage","e","preventDefault","obj","photoUri","msg","time","Date","map","message","i","target","value"],"mappings":"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","sourcesContent":["import React, { useState ,useEffect,useRef} from 'react'\r\nimport './Chat.css'\r\nimport {Avatar,IconButton} from \"@material-ui/core\";\r\nimport EmojiEmotionsOutlinedIcon from '@material-ui/icons/EmojiEmotionsOutlined';\r\nimport AddIcCallOutlinedIcon from '@material-ui/icons/AddIcCallOutlined';\r\nimport { CookiesProvider, Cookies,useCookies } from 'react-cookie';\r\nimport io from \"socket.io-client\";\r\nimport axios from \"axios\";\r\n\r\n \r\nfunction Chat(props) {\r\n    const cookies = new Cookies();\r\n    const userCookie=cookies.get('userCookie');\r\n    const userName=userCookie.name;\r\n    const socketRef = useRef();\r\n    const [input,setInput] = useState('');\r\n    const [messages,setMessages]=useState([]);\r\n    console.log(\"Test\");\r\n\r\n    const url = (process.env.NODE_ENV===\"production\" ? \"https://thawing-dawn-49846.herokuapp.com/\" : \"http://localhost:5000/\");\r\n    console.log(process.env.NODE_ENV,url);\r\n\r\n    const userDetail={\r\n        room:props.roomID,\r\n        name:userCookie.name,\r\n        GID:userCookie.GID,\r\n        imgURI:\"123\"\r\n    }\r\n\r\n    window.onbeforeunload =()=>{\r\n        if(socketRef.current){\r\n            socketRef.current.close();\r\n        } \r\n    }\r\n\r\n    useEffect(() => {\r\n       \r\n        axios.get(`${url}chat?room=${props.roomID}`).then((res)=>{\r\n            console.log(res.data);\r\n            setMessages(res.data);\r\n        })\r\n\r\n\r\n        socketRef.current=io.connect(url);\r\n        socketRef.current.emit(\"join chat room\",userDetail);\r\n\r\n        console.log(\"Inside UseEffect : \",messages);\r\n\r\n        socketRef.current.on('recevied msg',(data)=>{\r\n            console.log(\"yes received..\");\r\n            setMessages((msgs)=>[...msgs,data]);\r\n            console.log(messages);\r\n        });\r\n\r\n    },[]);\r\n\r\n    \r\n\r\n    const sendMessage = (e)=>{\r\n        e.preventDefault();\r\n        const obj={\r\n            userName,\r\n            photoUri:\"123\",\r\n            msg:input,\r\n            time:new Date,\r\n            room:props.roomID\r\n        }\r\n        socketRef.current.emit('send msg',obj);\r\n    //     axios.post(`${url}chat`,obj,{headers: {\r\n    //     'Content-Type': 'application/json'\r\n    //   }}).then((res)=>{\r\n    //         console.log(res);\r\n    //     })\r\n        setInput('');\r\n    }\r\n\r\n\r\n    return (\r\n        <div className = 'chat'>\r\n            <div className=\"chat__header\">\r\n            <Avatar  src = \"\"/>\r\n            <p>Room Name</p>\r\n            </div>\r\n\r\n            <div className=\"chat__body\">\r\n                {messages.map((message,i)=>{\r\n                    return(\r\n                        <p key={i} className={`chat__message ${userCookie.name === message.userName && 'chat__receiver'}`}>\r\n                            <span className='chat__name'>{message.userName}</span>\r\n                            {message.msg}\r\n                            <span className='chat__timestamp'>{message.time}</span>\r\n                        </p>\r\n                    )\r\n                })}\r\n                \r\n            </div>\r\n            <div className='chat__footer'>\r\n                <IconButton>\r\n                    <EmojiEmotionsOutlinedIcon></EmojiEmotionsOutlinedIcon>\r\n                </IconButton>\r\n                <form>\r\n                    <input value = {input} onChange = { (e)=> setInput(e.target.value)} placeholder='Type a message' type='text'> \r\n                    </input>\r\n                    <button onClick = {sendMessage} type = 'submit'>Send message</button>\r\n                </form>\r\n                <IconButton>\r\n                  <AddIcCallOutlinedIcon></AddIcCallOutlinedIcon>\r\n                </IconButton>\r\n            </div>\r\n            \r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Chat\r\n"]},"metadata":{},"sourceType":"module"}